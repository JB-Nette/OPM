// imports
import org.micromanager.display.DisplayWindow;
import org.micromanager.MultiStagePosition;
import org.micromanager.SequenceSettings;
import org.micromanager.api.AcquisitionOptions;
import org.micromanager.data.Coords;
import org.micromanager.data.Datastore;
import org.micromanager.data.Image;
import org.micromanager.data.Metadata;
import org.micromanager.data.Metadata.MetadataBuilder;
import org.micromanager.data.SummaryMetadata;
import org.micromanager.data.SummaryMetadataBuilder;

import mmcorej.*;

import java.awt.geom.Point2D;
import java.lang.System;
import java.lang.Math;
import java.lang.String;
import java.text.SimpleDateFormat;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import ij.gui.GenericDialog;
import ij.ImagePlus;
import ij.ImageStack;


// assign the core to mmc variable
mmc = mm.getCore();

// clean up any existing acquisitions
mmc.clearCircularBuffer();


// Setup PLC card to give start trigger

String plcName = "PLogic:E:36";
String propPosition = "PointerPosition";
String propCellConfig = "EditCellConfig";
int addrOutputBNC3 = 35;
int addrHigh = 64;  // TTL5 on Tiger backplane = stage sync signal
int addrLow = 0;
 
// connect to BNC output
mmc.setProperty(plcName, propPosition, addrOutputBNC3);
mmc.setProperty(plcName, propCellConfig, addrHigh);
mmc.sleep(5000);
mmc.setProperty(plcName, propCellConfig, addrLow);